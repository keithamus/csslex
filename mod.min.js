export const types={COMMENT:1,IDENT:2,FUNCTION:3,AT_KEYWORD:4,HASH:5,STRING:6,BAD_STRING:7,URL:8,BAD_URL:9,DELIM:10,NUMBER:11,PERCENTAGE:12,DIMENSION:13,WHITESPACE:14,CDO:15,CDC:16,COLON:17,SEMICOLON:18,COMMA:19,LEFT_SQUARE:20,RIGHT_SQUARE:21,LEFT_PAREN:22,RIGHT_PAREN:23,LEFT_CURLY:24,RIGHT_CURLY:25};let e=e=>(48^e)<=9||(32|e)>=97&&(32|e)<=102,r=e=>95===e||e>=128||(32|e)>=97&&(32|e)<=122,t=e=>45===e||(48^e)<=9||r(e),a=e=>10===e||12===e||13===e,c=e=>a(e)||32===e||9===e,l=e=>34===e||39===e,s=e=>e>=0&&e<=8||11===e||e>=14&&e<=31||127==e,n={40:22,41:23,44:19,58:17,59:18,91:20,93:21,123:24,125:25},o=[];for(let e=0;e<128;e+=1)o[e]=s(e)&&1||c(e)&&2||l(e)&&3||(48^e)<=9&&4||n[e]&&5||(43===e||45===e)&&6||r(e)&&7||e;let i=(e,r)=>o[e.charCodeAt(r)]||7,h=(e,r)=>92===e.charCodeAt(r)&&!a(e.charCodeAt(r+1)),C=(e,r)=>{let t=i(e,r),a=i(e,r+1);return 4===t||6===t&&4===a||6===t&&46===a&&4===i(e,r+2)||46===t&&4===a},u=(e,r)=>(45===e.charCodeAt(r)&&(r+=1),45===e.charCodeAt(r)||e.length>r&&7===i(e,r)||h(e,r)),d=(e,r,t)=>{for(;i(e,r)===t;)r+=1;return r},A=(r,t)=>{if((t+=2)>r.length)return r.length;if(e(r.charCodeAt(t-1))){for(let a=0;e(r.charCodeAt(t))&&a<5;a+=1,t+=1);2===i(r,t)&&(t+=1)}return t},f=r=>{if(!e(r.charCodeAt(0)))return r[0]||"�";let t=parseInt(r,16)||0;return t>1114111||t<=0||t>=55296&&t<=57343?"�":String.fromCodePoint(t)},b=(e,r)=>{let a=e.length;for(;r<a;)if(t(e.charCodeAt(r)))r+=1;else if(h(e,r))r=A(e,r);else break;return r},k=e=>{let r="";for(let a=0;a<e.length;)if(t(e.charCodeAt(a)))r+=e[a],a+=1;else if(h(e,a))r+=f(e.slice(a+1,a=A(e,a)));else break;return r},E=(e,r)=>{let t=i(e,r);return(6===t||46===t)&&(r+=1),r=d(e,r,4),46===i(e,r)&&4===i(e,r+1)&&(r=d(e,r+2,4)),t=i(e,r+1),(32|e.charCodeAt(r))==101&&(6===t||4===t)&&(r=d(e,r+2,4)),r},R=(e,r)=>{let t=8,a=e.length;for(r=d(e,r,2);r<a;){let a=e.charCodeAt(r),c=i(e,r);if(41===a){r+=1;break}if(8===t&&(3===c||40===a||1===c))t=9;else if(92===a)h(e,r)?r=A(e,r):(r+=1,t=9);else if(2===c){if(r=d(e,r,2),a=e.charCodeAt(r)){if(41===a){r+=1;break}t=9}else break}else r+=1}return[t,r]},N=(e,r)=>{let t=r;if(r=b(e,r),40===e.charCodeAt(r)){let a=d(e,r+1,2);return a-(r+=1)<=4&&"url"==k(e.slice(t,r-1)).toLowerCase()&&3!==i(e,a)?R(e,r):[3,r]}return[2,r]},T=(e,r)=>{r=E(e,r);let t=11;return 37===e.charCodeAt(r)?(r+=1,t=12):u(e,r)&&(r=b(e,r),t=13),[t,r]},I=(e,r)=>{let t=e.charCodeAt(r);r+=1;let c=e.length;for(;r<c;)switch(e.charCodeAt(r)){case t:return[6,r+=1];case 10:case 12:case 13:return[7,r];case 92:r==c-1?r+=1:a(e.charCodeAt(r+1))?r+=2:h(e,r)&&(r=A(e,r));break;default:r+=1}return[6,r]};export function*lex(e){let r;let a=e.length,c=0,l=0;for(;l<a;){switch(i(e,l)){case 2:l=d(e,l,2),r=14;break;case 3:[r,l]=I(e,l);break;case 4:[r,l]=T(e,l);break;case 6:C(e,l)?[r,l]=T(e,l):45===e.charCodeAt(l)&&45===e.charCodeAt(l+1)&&62===e.charCodeAt(l+2)?(r=16,l+=3):45===e.charCodeAt(l)&&u(e,l)?[r,l]=N(e,l):(r=10,l+=1);break;case 46:C(e,l)?[r,l]=T(e,l):(r=10,l+=1);break;case 7:[r,l]=N(e,l);break;case 60:33===e.charCodeAt(l+1)&&45===e.charCodeAt(l+2)&&45===e.charCodeAt(l+3)?(r=15,l+=4):(r=10,l+=1);break;case 35:t(e.charCodeAt(l+1))||h(e,l+1)?(l=b(e,l+1),r=5):(r=10,l+=1);break;case 64:u(e,l+1)?(l=b(e,l+1),r=4):(r=10,l+=1);break;case 92:h(e,l)?[r,l]=N(e,l):(r=10,l+=1);break;case 47:42===e.charCodeAt(l+1)?(-1===(l=e.indexOf("*/",l+2))&&(l=a),r=1,l=l===a?l:l+2):(r=10,l+=1);break;case 5:r=n[e.charCodeAt(l)],l+=1;break;default:r=10,l+=1}yield[r,c,c=l]}}export const value=(e,[r,t,n])=>{switch(r){case 1:return e.slice(t+2,n-2);case 6:{let r=e.charCodeAt(t),c="";for(let l=t+1;l<n;l+=1)switch(e.charCodeAt(l)){case r:return c;case 92:if(l+1===n&&n===e.length)return c;if(a(e.charCodeAt(l+1))){l+=1;break}if(h(e,l)){c+=f(e.slice(l+1,l=A(e,l))),l-=1;break}default:c+=e[l]}return c}case 10:return e[t];case 12:case 13:case 11:{let a=E(e,t),c=e.slice(t,a),l=parseFloat(c)||0,s=c.includes(".")||c.includes("E")||c.includes("e")?"number":"integer";if(13===r)return{type:s,value:l,unit:k(e.slice(a,n))};return{type:s,value:l}}case 5:{let r=u(e,t+1)?"id":"unrestricted",a=k(e.slice(t+1,n));return{type:r,value:a}}case 4:t+=1;case 3:case 2:return k(e.slice(t,n));case 8:{let r="",a=b(e,t)+1;for(a=d(e,a,2);a<e.length;){let t=e[a];if(")"===t){a+=1;break}if(l(e.charCodeAt(a))||"("===t||s(e.charCodeAt(a)))return null;if("\\"===t){if(!h(e,a))return null;t=f(e.slice(a+1,a=A(e,a)))}else if(c(e.charCodeAt(a))){if(a=d(e,a,2),!(t=e[a]))break;if(")"!==t)return null;a+=1;break}else a+=1;r+=t}return r}default:return null}};
